
[ENG-1536] model selector in launch modal - doesn't work, models are old/fake
Status: spec in progress
Assignee: allison@humanlayer.dev

Description:
![model selector gif.gif](https://uploads.linear.app/3ee2840f-7196-42ab-91f2-73ab50c48671/e58f2e10-eba6-45d8-a7c4-cad55bfb7fca/296a029e-9f9c-4c3b-9ed6-22d93ab9d4a3)

these models are fake, doesn't do anything - we should remove or fix it (sonnet and opus)

we should honor the user's settings 

![Screenshot 2025-07-07 at 9.12.01â€¯AM.png](https://uploads.linear.app/3ee2840f-7196-42ab-91f2-73ab50c48671/ff11248d-c1ca-499c-9625-3546a042fccf/0aa12510-cc20-4244-8cd0-91320d431daf)

Comments:
[2025-07-07] allison@humanlayer.dev:
Note: The findings above are based on research documented in `thoughts/shared/research/2025-07-07_10-19-26_wui_model_selection_issue.md`

[2025-07-07] allison@humanlayer.dev:
## Research Findings

Investigated the model selection issue across WUI, daemon, and claudecode-go. Found the root cause:

**Problem**: The WUI sends full model IDs (e.g., `"claude-3-5-sonnet-20241022"`) while the daemon only accepts `"opus"` or `"sonnet"` strings. Any other value is silently ignored, resulting in empty model storage.

**Primary Fix**: Update the WUI model selector to send `"opus"` and `"sonnet"` values that match what the daemon expects. The current hardcoded options in `CommandInput.tsx` should map to these simple strings.

**Additional Discovery**: The daemon never captures Claude's actual model selection from the init event. It only processes `subtype="session_created"` events, not `subtype="init"` where Claude reports its model.

**Potential Follow-up Tickets**:
1. **Capture model from init event**: Add handler for init events to store Claude's actual model selection (would require adding Model field to SessionUpdate struct)
2. **Model validation**: Consider returning errors instead of silently ignoring invalid model values

The research document contains full technical details including file paths and line numbers.

[2025-07-07] allison@humanlayer.dev:
I just want to use "Sonnet" and "Opus" which map to "sonnet" and "opus"


View in Linear: https://linear.app/humanlayer/issue/ENG-1536/model-selector-in-launch-modal-doesnt-work-models-are-oldfake
