
[ENG-1525] Update WUI to display rich diffs using file snapshots from new API
Status: Spec Needed

Description:
Current WUI only shows isolated find/replace strings without context. Use the new snapshot API to display full diffs with syntax highlighting and line numbers.

## Key Details

* Fetch snapshots via new API when rendering Edit/Write/MultiEdit tools
* For Edit: Apply changes to snapshot and show diff
* For Write: Show full content with syntax highlighting
* For MultiEdit: Apply all edits sequentially and show unified diff
* Use existing `react-diff-viewer-continued` with full context
* Enable line numbers (now accurate with full content)
* Add syntax highlighting via starry-night
* Cache snapshots in memory during session
* Gracefully handle missing snapshots (fall back to current behavior)

## Implementation Notes

Update diff rendering logic in `humanlayer-wui/src/components/internal/SessionDetail.tsx:258-321`. The component already uses react-diff-viewer-continued but needs full file content to work properly.

## References

* Source: `thoughts/shared/research/2025-07-03_09-43-22_wui_diff_view_tickets.md` ([View on GitHub](https://github.com/humanlayer/thoughts/blob/main/repos/humanlayer/shared/research/2025-07-03_09-43-22_wui_diff_view_tickets.md))
* Related code: `humanlayer-wui/src/components/internal/SessionDetail.tsx:278-280`
* Parent ticket: [ENG-1502](https://linear.app/humanlayer/issue/ENG-1502/make-tickets-to-improve-diff-views)

Comments:
[2025-07-07 12:01:10] allison@humanlayer.dev:
Will plan on doing this plan after [ENG-1520](https://linear.app/humanlayer/issue/ENG-1520/implement-file-snapshot-system-to-capture-full-content-during-read) and [ENG-1523](https://linear.app/humanlayer/issue/ENG-1523/create-json-rpc-endpoint-to-retrieve-file-snapshots-for-frontend) in case things change while implementing or plan feedback comes in.

[2025-07-09 09:56:21] Dexter Horthy:
vibing a diff viewer. @sundeep still votes library.

![Screenshot 2025-07-09 at 9.56.07 AM.png](https://uploads.linear.app/3ee2840f-7196-42ab-91f2-73ab50c48671/a8d69c9c-bf92-4b4c-a1b6-70ff84141a91/7e5e14e5-6f5e-45fb-a8fc-1429a64d328a)

[2025-07-09 09:56:39] Dexter Horthy:
![Screenshot 2025-07-09 at 9.56.32 AM.png](https://uploads.linear.app/3ee2840f-7196-42ab-91f2-73ab50c48671/0b6bc5a0-932d-4759-9073-047d377e92a9/83633368-5a0a-41df-954c-a8b9605c61d4)

interface


View in Linear: https://linear.app/humanlayer/issue/ENG-1525/update-wui-to-display-rich-diffs-using-file-snapshots-from-new-api
